---
import type { Blog } from '@/types'
import clsx from 'clsx'
import { BoxIcon, LinkIcon, RssIcon } from 'lucide-react'

export type FeedItem = {
  href: string
  name: string
  date: Date
}

export type WebsiteItem = {
  href: string
}

interface Props {
  className: string
  featured: Blog
  feed: FeedItem[]
}

const { featured, feed, className: classList } = Astro.props

const featuredImage = featured.data.heroImage

const websites = [
  "https://soladex.co",
  "https://consoledump.io",
  "https://polyblog.com"
]

export type LinkItem = {
  name: string
  icon: typeof BoxIcon | typeof LinkIcon | typeof RssIcon
  tint: string
  href: string
}

const pages: LinkItem[] = [
  {
    name: "Apps",
    icon: BoxIcon,
    tint: "oklch(72.3% 0.219 149.579)",
    href: "/tools"
  },
  {
    name: "Links",
    icon: LinkIcon,
    tint: "oklch(76.9% 0.188 70.08)",
    href: "/tools"
  },
  {
    name: "Socials",
    icon: RssIcon,
    tint: "oklch(51.1% 0.262 276.966)",
    href: "/tools"
  }
]

---
<div class={clsx("p-4", classList)}>
  <!-- Bento Box Container -->
  <div class="grid grid-cols-1 md:grid-cols-3 gap-4">

    <!-- <div class="col-span-1 row-span-3 rounded-3xl bg-zinc-900 overflow-hidden">
      <p>Left</p>
    </div> -->
    
    <!-- Featured Box (spans 2 columns on medium screens and up) -->
    <a href={`/blog/${featured.id}`} class="bg-yellow-500/10 overflow-hidden rounded-2xl shadow-md md:row-span-2 md:col-span-2 h-96 relative group">
      <!-- Background Image Layer -->
      <div class="absolute inset-0 transform -rotate-3 scale-120 transition-transform duration-700 
              group-hover:scale-125 group-hover:animate-pulse" 
          style={`background-image: url(${featuredImage}); background-position: center; background-size: cover;`}>
      </div>
      
      <!-- Overlay Layer with Blur -->
      <div class="absolute inset-0 bg-gradient-to-b to-black/90 from-black/5 via-black/60"></div>
      
      <!-- Content Layer -->
      <div class="relative z-10 flex w-full h-full p-4 flex-col">
        <div class="flex flex-1 gap-y-1"></div>
        <p class="text-4xl font-black text-white text-shadow">{featured.data.title}</p>
        <p class="text-sm line-clamp-1 text-white max-w-3/5 text-ellipsis">{featured.data.description}</p>
      </div>
    </a>
    
    <!-- Sidebar Box (now spans 2 rows) -->
    <div class="bg-zinc-900 p-6 rounded-2xl md:row-span-2 h-96 overflow-y-auto flex flex-col">
      <h2 class="text-xl text-blue-400 font-bold mb-4">Activity Feed</h2>
      <div class="h-1 bg-zinc-700" />
      <div class="flex-1 overflow-auto inset-1">
        {
          feed.map((item) => {
            return (
              <a class="flex gap-x-4 flex-row hover:text-yellow-500 transform duration-300 opacity-60 hover:opacity-100 justify-between pt-4" href={item.href}>
                <p class="text-sm hover:text-yellow-500 font-normal text-white line-clamp-1">{item.name}</p>
                <p class="text-xs text-white/30">{item.date.toLocaleDateString()}</p>
              </a>
            )
          })
        }
      </div>
    </div>
    
    <!-- Wide Box (spans full width) -->
    <div class="col-span-1 md:col-span-3 h-64 flex items-center gap-4 justify-center">
      {
        pages.map((page) => {
          return (
            <div class="basis-1/3 h-full rounded-2xl bg-zinc-900 flex flex-col items-center justify-center gap-y-4 overflow-hidden"
                style={`${page.tint}`}
            >
              <page.icon color={page.tint} size={64} class:list="opacity-70" />
              <p class="text-3xl font-black text-white">{page.name}</p>
            </div>
          )
        })
      }
    </div>
  </div>
</div>
<style>
#bento-featured {
  background-image: url(featuredImage);
  background-position: center;
  background-size: cover;
}
</style>