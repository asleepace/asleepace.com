---
import { cn } from '@/lib/utils/cn'

/**
 * @file src/components/astro/htmx-skeleton.astro
 * @description a generic div which can be used with htmx.
 *
 * ```html
 *  <Skeleton url="/partials/spy-price" trigger="every 30s">
 *    <p>Hello world</p>
 *  </Skeleton>
 * ```
 */
interface Props {
  url: string
  trigger?: string
  swap?: string
  target?: string
  indicator?: string
  class?: string
  loadingClass?: string
  loadingText?: string
}

const {
  url,
  trigger = 'load',
  swap = 'innerHTML',
  target,
  indicator,
  class: className,
  loadingClass = 'animate-pulse bg-gray-200 h-full',
  loadingText = 'Loading...',
} = Astro.props

const hasSlot = Astro.slots.has('default')
---

<div hx-get={url} hx-trigger={trigger} hx-swap={swap} hx-target={target} hx-indicator={indicator} class={className}>
  {
    hasSlot ? (
      <slot />
    ) : (
      <div class={cn('animate-pulse bg-gray-200 h-full', loadingClass)}>
        <p class="text-transparent">{loadingText}</p>
      </div>
    )
  }
</div>
