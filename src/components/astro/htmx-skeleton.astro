---
import { cn } from '@/lib/utils'

/**
 * @file src/components/astro/htmx-skeleton.astro
 * @description a generic div which can be used with htmx.
 *
 * ```html
<!-- Basic auto-refresh -->
<Skeleton 
  url="/partials/spy-price" 
  trigger="every 30s" 
/>

<!-- Load into different target -->
<div id="price-container"></div>
<Skeleton 
  url="/partials/spy-price"
  target="#price-container"
  swap="innerHTML"
/>

<!-- Custom loading state -->
<Skeleton 
  url="/partials/spy-price"
  loadingClass="bg-blue-100 rounded-lg p-4"
  loadingText="Fetching stock data..."
/>

<!-- With loading indicator -->
<Skeleton 
  url="/partials/spy-price"
  indicator="#loading-spinner"
/>
 * ```
 */
interface Props {
  url: string
  trigger?: string
  swap?: string
  target?: string
  indicator?: string
  class?: string
  loadingClass?: string
  loadingText?: string
  width?: number
  height?: number
}

const {
  url,
  trigger = 'load',
  swap = 'innerHTML',
  target,
  indicator,
  class: className,
  loadingClass = 'animate-pulse bg-gray-200 h-full',
  loadingText = 'Loading...',
  width,
} = Astro.props

const hasSlot = Astro.slots.has('default')
---

<div hx-get={url} hx-trigger={trigger} hx-swap={swap} hx-target={target} hx-indicator={indicator} class={className}>
  {
    hasSlot ? (
      <slot />
    ) : (
      <div class={cn('animate-pulse bg-gray-200 h-full', loadingClass)}>
        <p class="text-transparent">{loadingText}</p>
      </div>
    )
  }
</div>
