---
import BaseHead from "@/components/astro/BaseHead.astro"
import Header from "@/components/astro/Header.astro"
import Footer from "@/components/astro/Footer.astro"
import { PATH, siteData } from '@/consts'

export const prerender = false

/**
 *  NOTE: This page should clear the session cookie and redirect to the login page.
 * 
 *  The html should be rendered as a normal page, not as a redirect.
 * 
 *  @note the astro redirect() might act strange on this page.
 * 
 */
console.warn('[/admin/logout] clearing session...')

Astro.cookies.delete('session')
Astro.locals.isLoggedIn = false
Astro.locals.user = undefined

console.log('[/admin/logout] redirecting ...')

const META_REFRESH = `3; url=${PATH.ADMIN_LOGIN()}`

---
<!doctype html>
<html lang="en">
  <head>
    <BaseHead title={siteData.title} description={siteData.description} />
    <!-- NOTE: REDIRECT HAPPENS HERE -->
    <meta http-equiv={META_REFRESH}>
  </head>
  <body class="min-h-screen flex flex-col bg-white">
    <Header title={siteData.title} />
    <main class="flex flex-col flex-grow max-w-screen-lg justify-center items-center mx-auto px-4">
      <div class="flex flex-col gap-2">
        <p class="text-5xl font-bold text-center">Goodbye! ðŸ‘‹</p>
        <p class="text-center">You are now logged out, please come back soon!</p>  
        <div class="flex flex-col items-center gap-2">
          <a href="/">
            <button class="bg-blue-500 text-white rounded-md p-2">Go to Home</button>
          </a>
          <a href={PATH.ADMIN_LOGIN()}>
            <button class="bg-green-500 w-full text-white rounded-md p-2">Login</button>
          </a>
        </div>
    </main>
    <Footer />
  </body>
</html>